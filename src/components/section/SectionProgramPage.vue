<template>
  <v-row justify="center" id="program">
    <v-col cols="12" md="10">
      <v-card outlined elevation="0" class="pa-4 my-4">
        <v-card-title class="text-h4 mb-3 font-weight-bold">
          This is a preliminary schedule of the ISMIR 2025 program
        </v-card-title>

        <v-alert
          type="info"
          variant="tonal"
          class="mb-4"
          icon="mdi-calendar-plus"
        >
          <div class="text-body-2">
            <strong>üí° Tip:</strong> Click on any session to download a calendar
            event (.ics file) that you can add to Google Calendar, Outlook, or
            any calendar app!
          </div>
        </v-alert>

        <v-container fluid class="pa-0">
          <v-row>
            <v-col cols="12">
              <!-- Î°úÎî© ÏÉÅÌÉú -->
              <div v-if="loading" class="text-center pa-8">
                <v-progress-circular
                  indeterminate
                  color="primary"
                  size="64"
                ></v-progress-circular>
                <div class="mt-4 text-h6">Loading program data...</div>
              </div>

              <!-- ÏóêÎü¨ ÏÉÅÌÉú -->
              <div v-else-if="error" class="text-center pa-8">
                <v-alert type="error" prominent class="ma-4">
                  <div class="text-h6">Unable to load data</div>
                  <div class="mt-2">{{ error }}</div>
                  <v-btn color="primary" class="mt-4" @click="loadSheetData">
                    Try Again
                  </v-btn>
                </v-alert>
              </div>

              <!-- ÏùºÏùº ÌîÑÎ°úÍ∑∏Îû® Ïä§ÏºÄÏ§Ñ ÌÖåÏù¥Î∏î -->
              <div
                v-else-if="tableData.headers && tableData.rows"
                class="sheets-container"
              >
                <!-- Î™®Î∞îÏùº Ïä§ÌÅ¨Î°§ ÏïàÎÇ¥ Î©îÏãúÏßÄ -->
                <v-alert
                  v-if="$vuetify.display.mobile"
                  type="info"
                  variant="tonal"
                  class="mb-3"
                  icon="mdi-arrow-left-right"
                >
                  <div class="text-caption">
                    üì± <strong>Mobile Tip:</strong> Scroll left or right to view
                    the full program schedule!
                  </div>
                </v-alert>
                <table class="program-table" :style="getColumnStyle()">
                  <!-- 3Îã®Í≥Ñ Ìó§Îçî -->
                  <thead>
                    <!-- Ï≤´ Î≤àÏß∏ Ìñâ: ÎÇ†Ïßú -->
                    <tr class="date-row">
                      <th rowspan="4" class="time-header"></th>
                      <th class="date-cell">9/20</th>
                      <th class="date-cell">9/21</th>
                      <th class="date-cell">9/22</th>
                      <th class="date-cell">9/23</th>
                      <th class="date-cell">9/24</th>
                      <th class="date-cell">9/25</th>
                      <th class="date-cell" colspan="2">9/26</th>
                    </tr>

                    <!-- Îëê Î≤àÏß∏ Ìñâ: ÏöîÏùº -->
                    <tr class="day-row">
                      <th class="day-cell">Sat</th>
                      <th class="day-cell">Sun</th>
                      <th class="day-cell">Mon</th>
                      <th class="day-cell">Tue</th>
                      <th class="day-cell">Wed</th>
                      <th class="day-cell">Thu</th>
                      <th class="day-cell" colspan="2">Fri</th>
                    </tr>

                    <!-- ÏÑ∏ Î≤àÏß∏ Ìñâ: Ïù¥Î≤§Ìä∏ ÌÉÄÏûÖ -->
                    <tr class="event-type-row">
                      <th class="event-type-cell satellite">Satellite</th>
                      <th class="event-type-cell tutorial">Tutorial</th>
                      <th class="event-type-cell conference" colspan="4">
                        Conference
                      </th>
                      <th class="event-type-cell satellite" colspan="2">
                        Satellite
                      </th>
                    </tr>

                    <!-- ÎÑ§ Î≤àÏß∏ Ìñâ: Ïû•ÏÜå -->
                    <tr class="venue-row">
                      <th colspan="7" class="venue-cell main-venue">KAIST</th>
                      <th class="venue-cell sogang-venue">
                        Sogang Univ., Seoul
                      </th>
                    </tr>
                  </thead>

                  <!-- ÌÖåÏù¥Î∏î Î∞îÎîî -->
                  <tbody>
                    <tr
                      v-for="(row, rowIndex) in getProcessedRows()"
                      :key="rowIndex"
                      class="time-row"
                      :class="getTimeRowClass()"
                    >
                      <!-- ÏãúÍ∞Ñ Ïª¨Îüº -->
                      <td class="time-cell" :class="getTimeClass()">
                        {{ row.originalRow[0] || "" }}
                      </td>

                      <!-- ÏÑ∏ÏÖò Ïª¨ÎüºÎì§ -->
                      <td
                        v-for="(cell, cellIndex) in row.cells"
                        :key="cellIndex"
                        v-show="!cell.hidden"
                        class="session-cell"
                        :class="[
                          getSessionClass(cell.value),
                          { 'clickable-session': cell.isClickable },
                        ]"
                        :rowspan="cell.rowspan"
                        :colspan="cell.colspan"
                        @click="
                          handleCellClick(
                            $event,
                            cell.value,
                            rowIndex,
                            cellIndex,
                            cell.isClickable
                          )
                        "
                        :title="
                          cell.isClickable ? 'Click to add to calendar üìÖ' : ''
                        "
                      >
                        <div class="session-content">
                          {{ cell.value || "" }}
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>

                <!-- Ï∫òÎ¶∞Îçî ÏÑ†ÌÉù Î©îÎâ¥ -->
                <div
                  v-if="calendarMenuOpen"
                  class="calendar-menu-overlay"
                  @click="calendarMenuOpen = false"
                >
                  <v-card
                    class="calendar-menu-card"
                    :style="{
                      position: 'fixed',
                      left: menuPosition.x + 'px',
                      top: menuPosition.y + 'px',
                      zIndex: 10000,
                      minWidth: '250px',
                      maxWidth: '300px',
                    }"
                    @click.stop
                  >
                    <v-card-title class="text-subtitle-1 font-weight-bold pa-3">
                      üìÖ Add to Calendar
                    </v-card-title>
                    <v-divider></v-divider>
                    <v-list density="compact">
                      <v-list-item
                        v-for="calendar in availableCalendars"
                        :key="calendar.id"
                        @click="handleCalendarSelection(calendar)"
                        class="calendar-option"
                        :prepend-icon="getCalendarIcon(calendar.id)"
                      >
                        <v-list-item-title>{{
                          getCalendarName(calendar.id)
                        }}</v-list-item-title>
                        <template v-slot:append>
                          <v-icon
                            v-if="calendar.id === 'download'"
                            size="small"
                          >
                            mdi-download
                          </v-icon>
                          <v-icon v-else size="small"> mdi-open-in-new </v-icon>
                        </template>
                      </v-list-item>
                    </v-list>
                  </v-card>
                </div>
              </div>

              <!-- Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå -->
              <div v-else class="text-center pa-8">
                <v-alert type="info" prominent class="ma-4">
                  <div class="text-h6">
                    ÌîÑÎ°úÍ∑∏Îû® Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ëÏûÖÎãàÎã§...
                  </div>
                </v-alert>
              </div>
            </v-col>
          </v-row>
        </v-container>
      </v-card>
    </v-col>
  </v-row>
</template>

<script setup>
import { ref, onMounted, computed } from "vue";
import {
  downloadICSFile,
  isValidEvent,
  getAvailableCalendarOptions,
  generateGoogleCalendarUrl,
  generateOutlookUrl,
  generateAppleCalendarUrl,
} from "../../services/icsService";

// ISMIR 2025 ÌîÑÎ°úÍ∑∏Îû® Ïä§ÏºÄÏ§Ñ Îç∞Ïù¥ÌÑ∞ - CSV ÌååÏùº ÎÇ¥Ïö© ÏôÑÏ†Ñ ÌïòÎìúÏΩîÎî©
// ÏõêÎ≥∏ program.csvÏùò Î™®Îì† Îç∞Ïù¥ÌÑ∞Î•º JavaScript Î∞∞Ïó¥Î°ú Î≥ÄÌôò
const hardcodedProgramData = [
  // Ìó§Îçî Ï†ïÎ≥¥ (Ìñâ 0-3)
  ["", "9/20", "9/21", "9/22", "9/23", "9/24", "9/25", "9/26"],
  ["", "Sat", "Sun", "Mon", "Tue", "Wed", "Thu", "Fri"],
  [
    "",
    "Satelite event",
    "Tutorial",
    "Conference",
    "Conference",
    "Conference",
    "Conference",
    "Satelite event",
  ],
  [
    "Starting at (KST)",
    "@KAIST",
    "@KAIST",
    "@KAIST",
    "@KAIST",
    "@KAIST",
    "@KAIST",
    "@KAIST",
    "@Sogang Univ., Seoul",
  ],

  // Ïã§Ï†ú Ïä§ÏºÄÏ§Ñ Îç∞Ïù¥ÌÑ∞ (Ìñâ 4-79)
  ["07:00 - 07:30", "", "Registration", "", "", "", "", ""],
  ["07:30 - 08:00", "", "", "Registration", "", "", "", ""],
  [
    "08:00 - 08:30",
    "",
    "",
    "End",
    "Registration",
    "Registration",
    "Registration",
    "",
  ],
  [
    "08:30 - 09:00",
    "",
    "Registration",
    "Opening",
    "Registration",
    "Registration",
    "Registration",
    "",
  ],
  [
    "09:00 - 09:30",
    "",
    "Tutorial \n(T1, T2, T3)",
    "Oral \nSession 1",
    "Oral\nSession \n3",
    "Oral\nSession \n5",
    "Oral\nSession \n7",
    "LLM4MA",
    "DLfM",
  ],
  ["09:30 - 10:00", "", "", "", "", "", "", "", ""],
  ["10:00 - 10:30", "", "", "End", "End", "End", "End", "", ""],
  [
    "10:30 - 11:00",
    "",
    "",
    "coffee ‚òïÔ∏è \n+\nPoster \nSession 1",
    "coffee ‚òïÔ∏è \n+\nPoster\nSession \n3",
    "coffee ‚òïÔ∏è \n+\nPoster\nSession \n5",
    "coffee ‚òïÔ∏è \n+\nPoster\nSession \n7",
    "",
    "",
  ],
  ["11:00 - 11:30", "", "", "", "", "", "", "", ""],
  ["11:30 - 12:00", "", "", "End", "End", "End", "End", "", ""],
  [
    "12:00 - 12:30",
    "",
    "End",
    "Lunch ü•ó",
    "Lunch üçö",
    "Lunch üç±",
    "Lunch ü•ò",
    "",
    "",
  ],
  ["12:30 - 13:00", "", "Lunch üçΩÔ∏è", "End", "End", "End", "End", "", ""],
  [
    "13:00 - 13:30",
    "",
    "Lunch üçΩÔ∏è",
    "Keynote 1",
    "Industry \nSession",
    "Keynote 2",
    "Society Meeting / Board Election",
    "",
    "",
  ],
  ["13:30 - 14:00", "", "", "End", "End", "End", "End", "", ""],
  [
    "14:00 - 14:30",
    "HCMIR25",
    "Tutorial \n(T4, T5, T6)",
    "coffee ‚òïÔ∏è",
    "coffee ‚òïÔ∏è",
    "coffee ‚òïÔ∏è",
    "Award and Test-of-Time Talks",
    "",
    "",
  ],
  [
    "14:30 - 15:00",
    "",
    "",
    "Oral \nSession 2",
    "Oral\nSession\n4",
    "Oral\nSession\n6",
    "Closing Remarks, ISMIR 2026",
    "",
    "",
  ],
  ["15:00 - 15:30", "", "", "", "", "", "Late-Breaking/Demo", "", ""],
  ["15:30 - 16:00", "", "", "End", "End", "End", "", "", ""],
  [
    "16:00 - 16:30",
    "",
    "",
    "Poster \nSession 2",
    "Poster \nSession\n4",
    "Poster \nSession\n6",
    "",
    "",
    "",
  ],
  ["16:30 - 17:00", "", "", "", "", "", "End", "End", ""],
  ["17:00 - 17:30", "", "End", "End", "End", "End", "Unconference", "", ""],
  [
    "17:30 - 18:00",
    "End",
    "",
    "Industry ü•™ \nMeetup üçó",
    "WIMIR\nSession",
    "Special\nSession",
    "",
    "",
    "End",
  ],
  ["18:00 - 18:30", "", "", "", "End", "End", "End", "", ""],
  [
    "18:30 - 19:00",
    "",
    "Welcome \nReception",
    "End",
    "K-Culture Evening",
    "",
    "",
    "",
    "",
  ],
  ["19:00 - 19:30", "", "", "", "End", "", "", "", ""],
  [
    "19:30 - 20:00",
    "",
    "",
    "ISMIR\nMusic \nProgram",
    "Korean \nTraditional \nMusic Concert",
    "Banquet\n+\nJam session\nü•Åüé∏",
    "Rencon (TBD)",
    "",
    "",
  ],
  ["20:00 - 20:30", "", "", "End", "End", "", "End", "", ""],
  ["20:30 - 21:00", "", "", "", "", "", "", "", ""],
  ["21:00 - 21:30", "", "End", "", "", "", "", "", ""],
  ["21:30 - 22:00", "", "", "", "", "End", "", "", ""],
];

// Î∞òÏùëÌòï Îç∞Ïù¥ÌÑ∞
const loading = ref(false);
const error = ref(null);
const sheetData = ref([]);
const mergedCellsInfo = ref({});

// Ï∫òÎ¶∞Îçî Î©îÎâ¥ Í¥ÄÎ†® Îç∞Ïù¥ÌÑ∞
const calendarMenuOpen = ref(false);
const selectedEventData = ref(null);
const availableCalendars = ref(getAvailableCalendarOptions());
const menuPosition = ref({ x: 0, y: 0 });

// ÌÖåÏù¥Î∏î Îç∞Ïù¥ÌÑ∞ Í≥ÑÏÇ∞
const tableData = computed(() => {
  if (!sheetData.value || sheetData.value.length === 0) {
    return { headers: [], rows: [] };
  }

  const formattedData = formatDataAsTable(sheetData.value);

  // 8:30Î∂ÄÌÑ∞ 22:00ÍπåÏßÄÎßå ÌïÑÌÑ∞ÎßÅ (Welcome Reception, Banquet Ìè¨Ìï®)
  if (formattedData.rows && formattedData.rows.length > 0) {
    const filteredRows = formattedData.rows.filter((row) => {
      if (!row || !row[0]) return false;

      const time = row[0].toString().trim();

      // ÏãúÍ∞Ñ ÌòïÏãù ÌôïÏù∏ (Ïòà: "07:00 - 07:30", "09:00 - 09:30" Îì±)
      const timeMatch = time.match(
        /^(\d{1,2}):(\d{2})\s*-\s*(\d{1,2}):(\d{2})$/
      );
      if (!timeMatch) return false;

      const hours = parseInt(timeMatch[1]);
      const minutes = parseInt(timeMatch[2]);

      // 7:00 (7ÏãúÍ∞Ñ 0Î∂Ñ)Î∂ÄÌÑ∞ 22:00 (22ÏãúÍ∞Ñ 0Î∂Ñ)ÍπåÏßÄ
      const totalMinutes = hours * 60 + minutes;
      const startMinutes = 7 * 60; // 7:00
      const endMinutes = 22 * 60; // 22:00

      return totalMinutes >= startMinutes && totalMinutes <= endMinutes;
    });

    return {
      ...formattedData,
      rows: filteredRows,
    };
  }

  return formattedData;
});

// Vuetify DataTable Ìó§Îçî ÌòïÏãùÏúºÎ°ú Î≥ÄÌôò (ÌòÑÏû¨ ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÏùå)
// const tableHeaders = computed(() => {
//   if (!tableData.value.headers) return [];
//
//   return tableData.value.headers.map((header, index) => ({
//     text: header,
//     value: `col${index}`,
//     sortable: true,
//     width: 'auto'
//   }));
// });

// Í≥†Ï†ïÎêú Ïª¨Îüº Ïàò (9/20~9/25: 6Í∞ú + 9/26: 2Í∞ú = Ï¥ù 8Í∞ú)
const getColumnCount = computed(() => {
  return 8; // Í≥†Ï†ïÎêú 8Í∞ú Ïª¨Îüº
});

// ÎèôÏ†Å Ïª¨Îüº ÎÑàÎπÑ Ïä§ÌÉÄÏùº
const getColumnStyle = () => {
  const columnCount = getColumnCount.value;
  const sessionColumnWidth = `calc((100% - 120px) / ${columnCount})`;
  return {
    "--session-column-width": sessionColumnWidth,
  };
};

// ÏãúÍ∞Ñ Ìñâ Ïä§ÌÉÄÏùº ÌÅ¥ÎûòÏä§ Í≤∞Ï†ï - Î™®Îì† ÏãúÍ∞ÑÏù¥ ÎèôÏùºÌïú Ïä§ÌÉÄÏùº
const getTimeRowClass = () => {
  return ""; // ÌäπÎ≥ÑÌïú ÌÅ¥ÎûòÏä§ ÏóÜÏùå
};

// ÏãúÍ∞Ñ Ïä§ÌÉÄÏùº ÌÅ¥ÎûòÏä§ Í≤∞Ï†ï - Î™®Îì† ÏãúÍ∞ÑÏù¥ ÎèôÏùºÌïú Ïä§ÌÉÄÏùº
const getTimeClass = () => {
  return ""; // ÌäπÎ≥ÑÌïú ÌÅ¥ÎûòÏä§ ÏóÜÏùå
};

// ÏÑ∏ÏÖò Ïä§ÌÉÄÏùº ÌÅ¥ÎûòÏä§ Í≤∞Ï†ï - ÌïòÎäòÏÉâ ÌÜµÏùº Ï†ÅÏö©
const getSessionClass = (session) => {
  const classes = [];

  if (session && typeof session === "string") {
    // Ï§ÑÎ∞îÍøà Î¨∏ÏûêÎ•º Í≥µÎ∞±ÏúºÎ°ú Ï†ïÍ∑úÌôî
    const normalizedSession = session
      .replace(/\n/g, " ")
      .replace(/\s+/g, " ")
      .toLowerCase()
      .trim();

    console.log(
      `SESSION CLASSIFICATION: "${session}" ‚Üí "${normalizedSession}"`
    );

    // 1. Registration - Ïó∞Ìïú Ï¥àÎ°ùÏÉâ
    if (normalizedSession.includes("registration")) {
      classes.push("registration-session");
    }
    // 2. Tutorial, Oral Session, Keynote - ÌïòÎäòÏÉâ
    else if (
      normalizedSession.includes("tutorial") ||
      normalizedSession.includes("keynote") ||
      normalizedSession.includes("oral session")
    ) {
      classes.push("keynote-session"); // ÌïòÎäòÏÉâ ÌÅ¥ÎûòÏä§ ÏÇ¨Ïö©
    }
    // 2. Opening (Í∞úÌöåÏãù) - Î≤†Ïù¥ÏßÄ (LunchÏôÄ ÎèôÏùº)
    else if (normalizedSession.includes("opening")) {
      classes.push("lunch-session");
    }
    // 3. Poster Session (Ìè¨Ïä§ÌÑ∞) - ÎùºÎ≤§Îçî
    else if (normalizedSession.includes("poster session")) {
      classes.push("poster-session");
    }
    // 4. Industry Session (ÏÇ∞ÏóÖÍ≥Ñ) - Ïó∞Ï¥àÎ°ù, Industry MeetupÏùÄ Î≤†Ïù¥ÏßÄ (LunchÏôÄ ÎèôÏùº)
    else if (normalizedSession.includes("industry")) {
      if (normalizedSession.includes("meetup")) {
        classes.push("lunch-session"); // Industry MeetupÏùÄ LunchÏôÄ Í∞ôÏùÄ ÏÉâ
      } else {
        classes.push("industry-session"); // ÏùºÎ∞ò Industry SessionÏùÄ Ïó∞Ï¥àÎ°ù
      }
    }
    // 5. Lunch (Ï†êÏã¨) - Î≤†Ïù¥ÏßÄ
    else if (normalizedSession.includes("lunch")) {
      classes.push("lunch-session");
    }
    // 6. Coffee (Ïª§ÌîºÎßå) - Ïó∞Í∞àÏÉâ
    else if (
      normalizedSession.includes("coffee") &&
      !normalizedSession.includes("poster")
    ) {
      classes.push("coffee-session");
    }
    // 7. Coffee + Poster (Ïª§Ìîº + Ìè¨Ïä§ÌÑ∞) - ÎùºÎ≤§Îçî (Ìè¨Ïä§ÌÑ∞ÏôÄ ÌÜµÏùº)
    else if (
      normalizedSession.includes("coffee") &&
      normalizedSession.includes("poster")
    ) {
      classes.push("poster-session");
    }
    // 8. Social Events (ÏÇ¨ÍµêÌñâÏÇ¨) - ÏΩîÎûÑ ÌïëÌÅ¨
    else if (
      normalizedSession.includes("welcome") ||
      normalizedSession.includes("reception") ||
      normalizedSession.includes("banquet") ||
      normalizedSession.includes("jam") ||
      normalizedSession.includes("rencon") ||
      normalizedSession.includes("music program") ||
      normalizedSession.includes("k-culture") ||
      normalizedSession.includes("korean") ||
      normalizedSession.includes("traditional music") ||
      normalizedSession.includes("concert") ||
      (normalizedSession.includes("ismir") &&
        normalizedSession.includes("music"))
    ) {
      classes.push("social-session");
    }
    // 9. Closing/Award/Society meeting (ÌèêÌöåÏãù/ÏãúÏÉÅÏãù/ÌïôÌöå Î™®ÏûÑ) - Ïó∞Ï¥àÎ°ù
    else if (
      normalizedSession.includes("closing") ||
      normalizedSession.includes("award") ||
      normalizedSession.includes("society meeting")
    ) {
      classes.push("ceremony-session");
    }
    // 10. Special Events (ÌäπÎ≥Ñ Ïù¥Î≤§Ìä∏) - ÎØºÌä∏
    else if (
      normalizedSession.includes("llm4ma") ||
      normalizedSession.includes("dlfm") ||
      normalizedSession.includes("hcmir")
    ) {
      classes.push("special-event-session");
    }
    // 11. WIMIR/Diversity - ÌçºÌîå
    else if (
      normalizedSession.includes("wimir") ||
      normalizedSession.includes("special session")
    ) {
      classes.push("diversity-session");
    }
    // 12. Late-Breaking/Demo - ÎùºÎ≤§Îçî (Poster SessionÍ≥º ÎèôÏùº)
    else if (
      normalizedSession.includes("late-breaking") ||
      normalizedSession.includes("demo")
    ) {
      classes.push("poster-session");
    }
    // Í∏∞Î≥∏Í∞íÏùÄ ÏÑ∏ÏÖò Ïª¨Îüº Ïä§ÌÉÄÏùº Ïú†ÏßÄ
  }

  return classes.join(" ");
};

// ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞ Íµ¨Ï°∞ Î∂ÑÏÑù (Í∞ÑÎã®Ìïú Î≤ÑÏ†Ñ)
// eslint-disable-next-line no-unused-vars
const analyzeDataStructure = () => {
  console.log("=== ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù ===");
  console.log("ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞ÏóêÏÑúÎäî Î≥ëÌï© Î∂ÑÏÑùÏùÑ ÏÉùÎûµÌï©ÎãàÎã§.");
  console.log("=== END ANALYSIS ===");
};

// CSV Îç∞Ïù¥ÌÑ∞Ïùò ÏÑ∏Î°ú Î∞©Ìñ• Î∏îÎ°ùÏùÑ Ïù∏ÏãùÌïòÏó¨ rowspan Í≥ÑÏÇ∞
// eslint-disable-next-line no-unused-vars
const getSessionInfo = (cellValue, currentRowIndex, currentColIndex) => {
  if (!cellValue || typeof cellValue !== "string") {
    return { rowspan: 1, isSpanned: false, sessionType: "" };
  }

  const trimmedValue = cellValue.trim();
  if (!trimmedValue || trimmedValue.toLowerCase() === "end") {
    return { rowspan: 1, isSpanned: false, sessionType: "" };
  }

  // ÌòÑÏû¨ Ïª¨ÎüºÏóêÏÑú Îã§Ïùå "End" ÎòêÎäî Îã§Î•∏ Ïù¥Î≤§Ìä∏ÍπåÏßÄÏùò rowspan Í≥ÑÏÇ∞
  const allRows = tableData.value.rows;
  const actualColIndex = currentColIndex + 1; // ÏãúÍ∞Ñ Ïª¨Îüº Ï†úÏô∏

  let rowspan = 1;
  for (let i = currentRowIndex + 1; i < allRows.length; i++) {
    const nextCell =
      allRows[i] && allRows[i][actualColIndex]
        ? allRows[i][actualColIndex].trim()
        : "";

    if (nextCell === "" || nextCell === trimmedValue) {
      // Îπà ÏÖÄÏù¥Í±∞ÎÇò Í∞ôÏùÄ Ïù¥Î≤§Ìä∏Ïù¥Î©¥ Í≥ÑÏÜç ÌôïÏû•
      rowspan++;
    } else if (nextCell.toLowerCase() === "end") {
      // "End"Î•º ÎßåÎÇòÎ©¥ Ìï¥Îãπ ÌñâÍπåÏßÄ Ìè¨Ìï®ÌïòÍ≥† Ï¢ÖÎ£å
      rowspan++;
      break;
    } else {
      // Îã§Î•∏ Ïù¥Î≤§Ìä∏Î•º ÎßåÎÇòÎ©¥ Ïù¥Ï†Ñ ÌñâÍπåÏßÄÎßå
      break;
    }
  }

  console.log(
    `ROWSPAN Í≥ÑÏÇ∞: "${trimmedValue}" | Row ${currentRowIndex}, Col ${actualColIndex} | Rowspan: ${rowspan}`
  );

  return {
    rowspan,
    isSpanned: false,
    sessionType: rowspan > 1 ? "merged-block" : "single-cell",
  };
};

// ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞ÏóêÏÑúÎäî Í∞ÑÎã®Ìïú rowspan Í≥ÑÏÇ∞
// eslint-disable-next-line no-unused-vars
const calculateDynamicRowspan = (currentRowIndex, currentColIndex, allRows) => {
  // ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞ÏóêÏÑúÎäî Í∏∞Î≥∏Ï†ÅÏúºÎ°ú 1Í∞úÏùò ÌñâÎßå Ï∞®ÏßÄ
  return 1;
};

// ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞ÏóêÏÑúÎäî Í∞ÑÎã®Ìïú Ïù¥Î≤§Ìä∏ Ï≤òÎ¶¨
// eslint-disable-next-line no-unused-vars
const getColumnEvents = (colIndex, allRows) => {
  // ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞ÏóêÏÑúÎäî Îπà Î∞∞Ïó¥ Î∞òÌôò
  return [];
};

// ÌäπÏ†ï ÏãúÍ∞ÑÏóê Ìï¥ÎãπÌïòÎäî Ìñâ Ïù∏Îç±Ïä§ Ï∞æÍ∏∞
// eslint-disable-next-line no-unused-vars
const findRowIndexByTime = (targetTime, allRows) => {
  for (let i = 0; i < allRows.length; i++) {
    if (allRows[i] && allRows[i][0] === targetTime) {
      return i;
    }
  }
  return -1;
};

// ÌÖåÏù¥Î∏î ÌñâÏùÑ Ï≤òÎ¶¨ÌïòÏó¨ rowspanÏù¥ Ï†ÅÏö©Îêú ÏÖÄ Íµ¨Ï°∞ ÏÉùÏÑ±
const getProcessedRows = () => {
  if (!tableData.value.rows || tableData.value.rows.length === 0) return [];

  const rows = [];
  const spannedCells = new Set(); // Ïù¥ÎØ∏ spanÏúºÎ°ú Ïà®Í≤®ÏßÑ ÏÖÄÎì§ Ï∂îÏ†Å

  for (let rowIndex = 0; rowIndex < tableData.value.rows.length; rowIndex++) {
    const originalRow = tableData.value.rows[rowIndex];
    if (!originalRow) continue;

    const processedRow = {
      originalRow,
      cells: [],
    };

    // ÏãúÍ∞Ñ Ïª¨ÎüºÏùÑ Ï†úÏô∏Ìïú ÏÑ∏ÏÖò Ïª¨ÎüºÎì§ Ï≤òÎ¶¨
    for (let colIndex = 1; colIndex < originalRow.length; colIndex++) {
      const cellKey = `${rowIndex}-${colIndex}`;

      if (spannedCells.has(cellKey)) {
        // Ïù¥ÎØ∏ Ïù¥Ï†Ñ ÌñâÏùò rowspanÏóê Ìè¨Ìï®Îêú ÏÖÄÏùÄ Ïà®ÍπÄ
        processedRow.cells.push({
          value: "",
          hidden: true,
          rowspan: 1,
          colspan: 1,
          isClickable: false,
        });
        continue;
      }

      const cellValue = originalRow[colIndex] || "";

      // "End" ÎßàÏª§Ïù∏ Í≤ΩÏö∞ Ïà®ÍπÄ Ï≤òÎ¶¨ (rowspanÏóê Ìè¨Ìï®ÎêòÎØÄÎ°ú)
      if (cellValue && cellValue.trim().toLowerCase() === "end") {
        processedRow.cells.push({
          value: "",
          hidden: true,
          rowspan: 1,
          colspan: 1,
          isClickable: false,
        });
        continue;
      }

      const sessionInfo = getSessionInfo(cellValue, rowIndex, colIndex - 1); // colIndex - 1 because we're excluding time column

      // rowspan Ï†ÅÏö©
      if (sessionInfo.rowspan > 1) {
        // Ìï¥Îãπ ÏÖÄÏù¥ Ï∞®ÏßÄÌï† Îã§Î•∏ ÌñâÎì§ÏùÑ spannedCellsÏóê Ï∂îÍ∞Ä
        for (
          let r = rowIndex + 1;
          r < rowIndex + sessionInfo.rowspan && r < tableData.value.rows.length;
          r++
        ) {
          spannedCells.add(`${r}-${colIndex}`);
        }
      }

      processedRow.cells.push({
        value: cellValue,
        hidden: false,
        rowspan: sessionInfo.rowspan,
        colspan: 1,
        isClickable: isValidEvent(cellValue),
      });
    }

    rows.push(processedRow);
  }

  return rows;
};

// ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
const loadSheetData = async () => {
  loading.value = true;
  error.value = null;

  try {
    // ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
    sheetData.value = hardcodedProgramData;

    // Î≥ëÌï©Îêú ÏÖÄ Ï†ïÎ≥¥Îäî ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞ÏóêÏÑúÎäî ÏßÄÏõêÌïòÏßÄ ÏïäÏúºÎØÄÎ°ú Îπà Í∞ùÏ≤¥ ÏÇ¨Ïö©
    mergedCellsInfo.value = {};

    // ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞ÏóêÏÑúÎäî Î≥ëÌï© Ï†ïÎ≥¥Í∞Ä ÏóÜÏúºÎØÄÎ°ú Î≥ÑÎèÑ Ï≤òÎ¶¨ÌïòÏßÄ ÏïäÏùå
    // googleSheetsService.getMergedCellsInfo(metadata.sheets, "Program");

    // Îç∞Ïù¥ÌÑ∞ Íµ¨Ï°∞ ÎîîÎ≤ÑÍπÖ
    console.log("=== ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞ ÎîîÎ≤ÑÍπÖ ===");
    console.log("Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞:", hardcodedProgramData);
    if (hardcodedProgramData && hardcodedProgramData.length > 0) {
      console.log("Ï≤´ Î≤àÏß∏ Ìñâ (Ìó§Îçî):", hardcodedProgramData[0]);
      console.log("Îëê Î≤àÏß∏ Ìñâ:", hardcodedProgramData[1]);
      console.log("ÏÑ∏ Î≤àÏß∏ Ìñâ:", hardcodedProgramData[2]);
      console.log("ÎÑ§ Î≤àÏß∏ Ìñâ (Ïû•ÏÜå):", hardcodedProgramData[3]);
      console.log("Îã§ÏÑØ Î≤àÏß∏ Ìñâ:", hardcodedProgramData[4]);
      console.log("Ï≤´ Î≤àÏß∏ Îç∞Ïù¥ÌÑ∞ Ìñâ:", hardcodedProgramData[5]);
    }
    console.log("=== Î≥ÄÌôòÎêú ÌÖåÏù¥Î∏î Îç∞Ïù¥ÌÑ∞ ===");
    const formatted = formatDataAsTable(hardcodedProgramData);
    console.log("Ìó§Îçî:", formatted.headers);
    console.log("Ìñâ Í∞úÏàò:", formatted.rows.length);
    if (formatted.rows.length > 0) {
      console.log("Ï≤´ Î≤àÏß∏ Ìñâ:", formatted.rows[0]);
      console.log("Îëê Î≤àÏß∏ Ìñâ:", formatted.rows[1]);
    }
    console.log("===================");
  } catch (err) {
    console.error("Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïò§Î•ò:", err);
    error.value = err.message || "Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.";
  } finally {
    loading.value = false;
  }
};

// ÌïòÎìúÏΩîÎî©Îêú Îç∞Ïù¥ÌÑ∞Î•º ÏúÑÌïú ÌÖåÏù¥Î∏î ÌòïÏãù Î≥ÄÌôò Ìï®Ïàò
const formatDataAsTable = (data) => {
  if (!data || data.length === 0) {
    return { headers: [], rows: [] };
  }

  // Ìó§ÎçîÎäî Ï≤´ Î≤àÏß∏ Ìñâ(ÎÇ†Ïßú)ÏùÑ ÏÇ¨Ïö©
  const headers = data[0] || [];

  // Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞Îäî 4Î≤àÏß∏ ÌñâÎ∂ÄÌÑ∞ ÏãúÏûë (0-based indexÎ°ú 3Î≤àÏß∏)
  const rows = data.slice(4) || [];

  return {
    headers,
    rows,
  };
};

// ÏÖÄ ÌÅ¥Î¶≠ Ìï∏Îì§Îü¨
const handleCellClick = (
  event,
  cellValue,
  rowIndex,
  cellIndex,
  isClickable
) => {
  if (isClickable) {
    showCalendarMenu(event, cellValue, rowIndex, cellIndex);
  }
};

// Ï∫òÎ¶∞Îçî Î©îÎâ¥ ÌëúÏãú Ìï∏Îì§Îü¨
const showCalendarMenu = (event, cellValue, rowIndex, cellIndex) => {
  // Ïú†Ìö®Ìïú Ïù¥Î≤§Ìä∏Ïù∏ÏßÄ ÌôïÏù∏
  if (!isValidEvent(cellValue)) {
    return;
  }

  // Ìï¥Îãπ ÌñâÏùò ÏãúÍ∞Ñ Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
  const timeString = tableData.value.rows[rowIndex][0];
  if (!timeString) {
    console.warn("Time information not found");
    return;
  }

  // Ïª¨Îüº Ïù∏Îç±Ïä§Îäî 1Î∂ÄÌÑ∞ ÏãúÏûë (ÏãúÍ∞Ñ Ïª¨Îüº Ï†úÏô∏)
  const columnIndex = cellIndex + 1;

  // Ïù¥Î≤§Ìä∏ Îç∞Ïù¥ÌÑ∞ Íµ¨ÏÑ±
  const eventData = {
    title: cellValue,
    timeString: timeString,
    columnIndex: columnIndex,
  };

  // Î©îÎâ¥ ÏúÑÏπò ÏÑ§Ï†ï (ÌÅ¥Î¶≠Ìïú ÏúÑÏπò Í∏∞Ï§Ä, ÌôîÎ©¥ Í≤ΩÍ≥Ñ Í≥†Î†§)
  const menuWidth = 300;
  const menuHeight = 200;
  const padding = 10;

  let x = event.clientX;
  let y = event.clientY;

  // ÌôîÎ©¥ Ïò§Î•∏Ï™Ω Í≤ΩÍ≥ÑÎ•º Î≤óÏñ¥ÎÇòÎäî Í≤ΩÏö∞ ÏôºÏ™ΩÏúºÎ°ú Ïù¥Îèô
  if (x + menuWidth > window.innerWidth) {
    x = window.innerWidth - menuWidth - padding;
  }

  // ÌôîÎ©¥ ÏïÑÎûòÏ™Ω Í≤ΩÍ≥ÑÎ•º Î≤óÏñ¥ÎÇòÎäî Í≤ΩÏö∞ ÏúÑÎ°ú Ïù¥Îèô
  if (y + menuHeight > window.innerHeight) {
    y = window.innerHeight - menuHeight - padding;
  }

  // ÏµúÏÜå ÏúÑÏπò Î≥¥Ïû•
  x = Math.max(padding, x);
  y = Math.max(padding, y);

  menuPosition.value = { x, y };

  // ÏÑ†ÌÉùÎêú Ïù¥Î≤§Ìä∏ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
  selectedEventData.value = eventData;

  // Î©îÎâ¥ Ïó¥Í∏∞
  calendarMenuOpen.value = true;
};

// Ï∫òÎ¶∞Îçî ÏïÑÏù¥ÏΩò Î∞òÌôò
const getCalendarIcon = (calendarId) => {
  const icons = {
    google: "mdi-google",
    outlook: "mdi-microsoft-outlook",
    apple: "mdi-apple",
    download: "mdi-download-circle",
  };
  return icons[calendarId] || "mdi-calendar";
};

// Ï∫òÎ¶∞Îçî Ïù¥Î¶Ñ Î∞òÌôò (ÏòÅÏñ¥)
const getCalendarName = (calendarId) => {
  const names = {
    google: "Google Calendar",
    outlook: "Microsoft Outlook",
    apple: "Apple Calendar",
    download: "Download ICS File",
  };
  return names[calendarId] || "Calendar";
};

// Ï∫òÎ¶∞Îçî ÏÑ†ÌÉù Ìï∏Îì§Îü¨
const handleCalendarSelection = async (calendar) => {
  // Î©îÎâ¥ Îã´Í∏∞
  calendarMenuOpen.value = false;

  if (!selectedEventData.value) {
    console.error("No event data selected");
    return;
  }

  try {
    const calendarName = getCalendarName(calendar.id);
    console.log(`${calendarName} selected:`, selectedEventData.value);

    if (calendar.id === "download") {
      // ICS ÌååÏùº Îã§Ïö¥Î°úÎìú
      downloadICSFile(selectedEventData.value);
    } else if (calendar.id === "google") {
      // Google Calendar Ïó¥Í∏∞
      const url = generateGoogleCalendarUrl(selectedEventData.value);
      window.open(url, "_blank");
    } else if (calendar.id === "outlook") {
      // Outlook Ïó¥Í∏∞
      const url = generateOutlookUrl(selectedEventData.value);
      window.open(url, "_blank");
    } else if (calendar.id === "apple") {
      // Apple Calendar (iOS)
      const url = generateAppleCalendarUrl(selectedEventData.value);
      window.location.href = url;
    }
  } catch (error) {
    const calendarName = getCalendarName(calendar.id);
    console.error(`Error adding to ${calendarName}:`, error);
    // Ìè¥Î∞±: ICS Îã§Ïö¥Î°úÎìú
    downloadICSFile(selectedEventData.value);
  }
};

// Ïª¥Ìè¨ÎÑåÌä∏ ÎßàÏö¥Ìä∏ Ïãú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
onMounted(() => {
  loadSheetData();
});
</script>

<style scoped>
/* Ï†úÎ™©Ïù¥ ÏûòÎ¶¨ÏßÄ ÏïäÎèÑÎ°ù Ï§ÑÎ∞îÍøà ÌóàÏö© */
.v-card-title {
  white-space: normal !important;
  word-break: break-word !important;
  line-height: 1.4 !important;
}

/* Î™®Î∞îÏùºÏóêÏÑú Ï†úÎ™© Ìè∞Ìä∏ ÏÇ¨Ïù¥Ï¶à Ï°∞Ï†ï */
@media (max-width: 768px) {
  .v-card-title {
    font-size: 1.5rem !important;
  }
}

@media (max-width: 480px) {
  .v-card-title {
    font-size: 1.25rem !important;
  }
}

.sheets-container {
  position: relative;
  width: 100%;
  overflow: hidden;
  margin: 0;
  padding: 0;
}

/* Î™®Î∞îÏùºÏóêÏÑú Í∞ÄÎ°ú Ïä§ÌÅ¨Î°§ ÌôúÏÑ±Ìôî */
@media (max-width: 768px) {
  .sheets-container {
    overflow-x: auto;
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: thin;
    scrollbar-color: #ccc #f0f0f0;
  }

  .sheets-container::-webkit-scrollbar {
    height: 8px;
  }

  .sheets-container::-webkit-scrollbar-track {
    background: #f0f0f0;
    border-radius: 4px;
  }

  .sheets-container::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 4px;
  }

  .sheets-container::-webkit-scrollbar-thumb:hover {
    background: #999;
  }

  /* Ïä§ÌÅ¨Î°§ Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ Ïä§ÌÉÄÏùº */
  .sheets-container {
    position: relative;
  }

  .sheets-container::after {
    content: "‚Üê Scroll left or right ‚Üí";
    position: absolute;
    bottom: -25px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.7rem;
    color: #666;
    background: rgba(255, 255, 255, 0.9);
    padding: 2px 8px;
    border-radius: 10px;
    opacity: 0.8;
    pointer-events: none;
    white-space: nowrap;
    z-index: 1;
  }
}

/* ÏùºÏùº ÌîÑÎ°úÍ∑∏Îû® Ïä§ÏºÄÏ§Ñ ÌÖåÏù¥Î∏î Ïä§ÌÉÄÏùºÎßÅ */
.program-table {
  width: 100%;
  border-collapse: collapse;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  background: white;
  font-size: 1rem;
  table-layout: fixed; /* Í≥†Ï†ï ÌÖåÏù¥Î∏î Î†àÏù¥ÏïÑÏõÉÏúºÎ°ú Ïª¨Îüº ÎÑàÎπÑ ÏùºÏ†ïÌïòÍ≤å */
  border: 1px solid #000000; /* Ï†ÑÏ≤¥ Ìëú Î∞îÍπ• ÌÖåÎëêÎ¶¨ */
}

/* Î™®Î∞îÏùºÏóêÏÑú ÌÖåÏù¥Î∏î ÏµúÏÜå ÎÑàÎπÑ ÏÑ§Ï†ï */
@media (max-width: 768px) {
  .program-table {
    min-width: 800px; /* Î™®Îì† Ïª¨ÎüºÏù¥ Î≥¥Ïù¥ÎèÑÎ°ù ÏµúÏÜå ÎÑàÎπÑ ÏÑ§Ï†ï */
    table-layout: auto; /* Î™®Î∞îÏùºÏóêÏÑúÎäî ÏûêÎèô Î†àÏù¥ÏïÑÏõÉÏúºÎ°ú Î≥ÄÍ≤Ω */
  }
}

.program-table thead {
  background: #e7e7e7;
  color: #000000;
  font-weight: 600;
  position: sticky;
  top: 0;
  z-index: 10;
}

.time-header {
  padding: 16px 8px;
  border-right: 1px solid #000000;
  background-color: #ffffff;
  text-align: center;
  font-size: 0.875rem;
  min-height: 120px; /* 4Ìñâ Ìó§ÎçîÏóê ÎßûÍ≤å ÎÜíÏù¥ Ï¶ùÍ∞Ä */
  vertical-align: middle;
  width: 120px; /* ÏãúÍ∞Ñ Ïª¨Îüº Í≥†Ï†ï ÎÑàÎπÑ */
  font-weight: 700;
  box-shadow: none;
}

/* 4Îã®Í≥Ñ Ìó§Îçî Ïä§ÌÉÄÏùº - ÌöåÏÉâ ÌÜ§ Í≥ÑÏ∏µ Íµ¨Ï°∞ */

/* Ï≤´ Î≤àÏß∏ Ìñâ: ÎÇ†Ïßú (Í∞ÄÏû• Ïñ¥ÎëêÏö¥ ÌöåÏÉâ) */
.date-row {
  background: #d0d0d0;
  color: #000000;
}

.date-cell {
  padding: 8px 4px;
  border-right: 1px solid #000000;
  border-bottom: 1px solid #000000;
  text-align: center;
  vertical-align: middle;
  width: var(--session-column-width, calc((100% - 120px) / 8));
  font-size: 1rem;
  font-weight: 800;
  background-color: #d0d0d0;
  line-height: 1.2;
  letter-spacing: 0.5px;
}

/* Îëê Î≤àÏß∏ Ìñâ: ÏöîÏùº (Ï§ëÍ∞Ñ ÌÜ§ ÌöåÏÉâ) */
.day-row {
  background: #e0e0e0;
  color: #000000;
}

.day-cell {
  padding: 6px 4px;
  border-right: 1px solid #000000;
  border-bottom: 1px solid #000000;
  text-align: center;
  vertical-align: middle;
  width: var(--session-column-width, calc((100% - 120px) / 8));
  font-size: 0.9rem;
  font-weight: 600;
  background-color: #e0e0e0;
  line-height: 1.2;
  text-transform: uppercase;
}

/* ÏÑ∏ Î≤àÏß∏ Ìñâ: Ïù¥Î≤§Ìä∏ ÌÉÄÏûÖ (Î∞ùÏùÄ ÌöåÏÉâ) */
.event-type-row {
  background: #e7e7e7;
  color: #000000;
}

.event-type-cell {
  padding: 6px 4px;
  border-right: 1px solid #000000;
  border-bottom: 1px solid #000000;
  text-align: center;
  vertical-align: middle;
  width: var(--session-column-width, calc((100% - 120px) / 8));
  font-size: 0.85rem;
  font-weight: 600;
  background-color: #e7e7e7;
  color: #000000;
}

/* ÎÑ§ Î≤àÏß∏ Ìñâ: Ïû•ÏÜå (Í∞ÄÏû• Î∞ùÏùÄ ÌöåÏÉâ) */
.venue-row {
  background: #f5f5f5;
  color: #000000;
}

.venue-cell {
  padding: 6px 4px;
  border-right: 1px solid #000000;
  border-bottom: 1px solid #000000;
  text-align: center;
  vertical-align: middle;
  width: var(--session-column-width, calc((100% - 120px) / 8));
  font-size: 0.8rem;
  font-weight: 500;
  background-color: #f5f5f5;
  color: #000000;
}

.venue-cell.main-venue {
  font-weight: 600;
}

.venue-cell.sogang-venue {
  font-size: 0.6rem;
}

.time-row {
  border-bottom: 1px solid #000000;
  border-top: 1px solid #000000;
  transition: background-color 0.2s;
  min-height: 33px;
}

.time-row:hover {
  background-color: #f5f5f5;
}

.time-cell {
  padding: 6px 8px;
  border-right: 1px solid #000000;
  background-color: #e7e7e7;
  font-weight: 600;
  text-align: center;
  color: #000000;
  vertical-align: middle;
  font-size: 0.9rem;
  white-space: nowrap;
  width: 120px; /* ÏãúÍ∞Ñ Ïª¨Îüº Í≥†Ï†ï ÎÑàÎπÑ */
}

.session-cell {
  padding: 4px 6px;
  border-right: 1px solid #000000;
  border-bottom: 1px solid #000000;
  background-color: white;
  text-align: center;
  vertical-align: middle;
  word-wrap: break-word;
  line-height: 1.3;
  font-size: 0.85rem;
  position: relative;
  overflow: hidden; /* Í∏¥ ÌÖçÏä§Ìä∏ Ïà®ÍπÄ */
  width: var(--session-column-width, calc((100% - 120px) / 8));
}

.session-content {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
}

/* Íµ¨ Ìó§Îçî Ïä§ÌÉÄÏùº Ï†úÍ±∞Îê® - 3Îã®Í≥Ñ Ìó§ÎçîÎ°ú ÎåÄÏ≤¥ */

/* ÏãúÍ∞Ñ Ïä§ÌÉÄÏùº Ï†úÍ±∞Îê® - Î™®Îì† ÏãúÍ∞ÑÏù¥ ÎèôÏùºÌïú Ïä§ÌÉÄÏùº */

/* Ïù¥Î≤§Ìä∏Î≥Ñ ÏÉâÏÉÅ Ï†ïÏùò - Ï†úÍ≥µÎêú ÏÉâÏÉÅ Ïä§ÌéôÌä∏Îüº Í∏∞Î∞ò */

/* 1. Registration (Îì±Î°ù) - Ïó∞Ìïú Ï¥àÎ°ùÏÉâ: Îì±Î°ù/Ï†ëÏàò */
.registration-session {
  background-color: #e8f5e8 !important;
  color: #000000 !important;
  font-weight: 600 !important;
}

/* 2. Keynote, Tutorial, Oral Session (ÌïµÏã¨ Î∞úÌëú, ÌäúÌÜ†Î¶¨Ïñº, Íµ¨ÎëêÎ∞úÌëú) - ÌïòÎäòÏÉâ: ÌïôÏà†Ï†Å/Ï†ïÎ≥¥ Ï†ÑÎã¨ */
.keynote-session {
  background-color: #e6f2fd !important;
  color: #000000 !important;
  font-weight: 700 !important;
}

/* 2. Opening (Í∞úÌöåÏãù) - Î≤†Ïù¥ÏßÄ: LunchÏôÄ ÎèôÏùºÌïú ÏÉâÏÉÅ */

/* 3. Poster Session (Ìè¨Ïä§ÌÑ∞) - ÎùºÎ≤§Îçî: ÏÉÅÌò∏ÏûëÏö©/ÌÜ†Î°† */
.poster-session {
  background-color: #f3e5f5 !important;
  color: #000000 !important;
  font-weight: 600 !important;
}

/* 4. Industry Session (ÏÇ∞ÏóÖÍ≥Ñ) - Ïó∞Ï¥àÎ°ù: Ïã§Î¨¥/ÎπÑÏ¶àÎãàÏä§ */
.industry-session {
  background-color: #c8e6c9 !important;
  color: #000000 !important;
  font-weight: 600 !important;
}

/* 5. Lunch (Ï†êÏã¨) - Î≤†Ïù¥ÏßÄ: Ìú¥Ïãù/ÎÑ§Ìä∏ÏõåÌÇπ */
.lunch-session {
  background-color: #fff8dc !important;
  color: #000000 !important;
  font-weight: 500 !important;
  font-style: italic !important;
}

/* 6. Coffee (Ïª§Ìîº) - Ïó∞Í∞àÏÉâ: Ìú¥Ïãù/Ïπ¥Ìéò */
.coffee-session {
  background-color: #e6d0a3 !important;
  color: #000000 !important;
  font-weight: 500 !important;
  font-style: italic !important;
}

/* 7. Social Events (ÏÇ¨ÍµêÌñâÏÇ¨) - ÏΩîÎûÑ ÌïëÌÅ¨: ÏÇ¨Íµê/Ï¶êÍ±∞ÏõÄ */
.social-session {
  background-color: #ffb3ba !important;
  color: #000000 !important;
  font-weight: 600 !important;
}

/* 8. Closing/Award/Society meeting (ÌèêÌöåÏãù/ÏãúÏÉÅÏãù/ÌïôÌöå Î™®ÏûÑ) - Ïó∞Ï¥àÎ°ù: Í≥µÏãù/ÏùòÎ°Ä */
.ceremony-session {
  background-color: #c8e6c9 !important;
  color: #000000 !important;
  font-weight: 700 !important;
}

/* 9. Special Events (ÌäπÎ≥Ñ Ïù¥Î≤§Ìä∏) - Ïó∞Ï£ºÌô©: ÌäπÎ≥Ñ/ÎèÖÌäπÌï® */
.special-event-session {
  background-color: #ffe0b2 !important;
  color: #000000 !important;
  font-weight: 600 !important;
}

/* 10. WIMIR/Diversity - Ïó∞Ï¥àÎ°ù: Îã§ÏñëÏÑ±/Ìè¨Ïö©ÏÑ± */
.diversity-session {
  background-color: #c8e6c9 !important;
  color: #000000 !important;
  font-weight: 600 !important;
}

/* 11. Late-Breaking/Demo - ÎùºÎ≤§Îçî: Poster SessionÍ≥º ÎèôÏùº */
.demo-session {
  background-color: #ffe0b2 !important;
  color: #000000 !important;
  font-weight: 600 !important;
}

/* ÌäπÎ≥ÑÌïú ÏÑ∏ÏÖò Ïä§ÌÉÄÏùºÎßÅ */
.break-session {
  background-color: #f3e5f5 !important;
  font-style: italic !important;
}

.time-column {
  font-weight: 600 !important;
  color: #1976d2 !important;
  white-space: nowrap;
}

/* Í∏¥ ÏÑ∏ÏÖò Ïä§ÌÉÄÏùº */
.session-cell {
  position: relative;
}

/* ÌÅ¥Î¶≠ Í∞ÄÎä•Ìïú ÏÑ∏ÏÖò Ïä§ÌÉÄÏùº */
.clickable-session {
  cursor: pointer !important;
  transition: all 0.2s ease !important;
  position: relative !important;
}

.clickable-session:hover {
  transform: scale(1.02) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
  z-index: 5 !important;
}

.clickable-session:active {
  transform: scale(0.98) !important;
}

/* ÌÅ¥Î¶≠ Í∞ÄÎä•Ìïú ÏÑ∏ÏÖòÏóê Îã§Ïö¥Î°úÎìú ÏïÑÏù¥ÏΩò ÌûåÌä∏ Ï∂îÍ∞Ä */
.clickable-session::after {
  content: "üìÖ";
  position: absolute;
  top: 2px;
  right: 2px;
  font-size: 0.7rem;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.clickable-session:hover::after {
  opacity: 0.7;
}

/* Î∞òÏùëÌòï ÎîîÏûêÏù∏ */
@media (max-width: 1200px) {
  .date-cell {
    font-size: 0.9rem;
    padding: 6px 3px;
    line-height: 1.1;
  }

  .day-cell {
    font-size: 0.85rem;
    padding: 5px 3px;
  }

  .event-type-cell {
    font-size: 0.8rem;
    padding: 5px 3px;
  }

  .venue-cell {
    font-size: 0.75rem;
    padding: 5px 3px;
  }

  .venue-cell.sogang-venue {
    font-size: 0.7rem;
  }

  .session-cell {
    font-size: 0.85rem;
    padding: 4px 3px;
  }

  .time-cell {
    font-size: 0.85rem;
  }

  .time-header {
    font-size: 0.95rem;
    min-height: 105px; /* 4Ìñâ Ìó§ÎçîÏóê ÎßûÍ≤å Ï°∞Ï†ï */
  }
}

@media (max-width: 768px) {
  .date-cell {
    font-size: 0.85rem;
    padding: 6px 4px;
    line-height: 1.2;
    min-width: 80px; /* ÏµúÏÜå ÎÑàÎπÑ Î≥¥Ïû• */
  }

  .day-cell {
    font-size: 0.8rem;
    padding: 5px 4px;
    min-width: 80px;
  }

  .event-type-cell {
    font-size: 0.8rem;
    padding: 5px 4px;
    min-width: 80px;
  }

  .venue-cell {
    font-size: 0.75rem;
    padding: 5px 4px;
    min-width: 80px;
  }

  .venue-cell.sogang-venue {
    font-size: 0.7rem;
  }

  .session-cell {
    font-size: 0.75rem;
    padding: 4px 3px;
    min-width: 80px;
    line-height: 1.3;
  }

  .time-cell {
    font-size: 0.85rem;
    width: 80px; /* Î™®Î∞îÏùºÏóêÏÑú ÏãúÍ∞Ñ Ïª¨Îüº ÎÑàÎπÑ Ï¶ùÍ∞Ä */
    min-width: 80px;
    padding: 6px 4px;
  }

  .time-header {
    font-size: 0.9rem;
    min-height: 100px; /* 4Ìñâ Ìó§ÎçîÏóê ÎßûÍ≤å Ï°∞Ï†ï */
    width: 80px; /* Î™®Î∞îÏùºÏóêÏÑú ÏãúÍ∞Ñ Ïª¨Îüº ÎÑàÎπÑ Ï¶ùÍ∞Ä */
    min-width: 80px;
  }
}

@media (max-width: 480px) {
  .date-cell {
    font-size: 0.8rem;
    padding: 5px 3px;
    line-height: 1.1;
    min-width: 75px;
  }

  .day-cell {
    font-size: 0.75rem;
    padding: 4px 3px;
    min-width: 75px;
  }

  .event-type-cell {
    font-size: 0.75rem;
    padding: 4px 3px;
    min-width: 75px;
  }

  .venue-cell {
    font-size: 0.7rem;
    padding: 4px 3px;
    min-width: 75px;
  }

  .venue-cell.sogang-venue {
    font-size: 0.65rem;
  }

  .session-cell {
    font-size: 0.7rem;
    padding: 3px 2px;
    min-width: 75px;
    line-height: 1.2;
  }

  .time-cell {
    font-size: 0.8rem;
    width: 75px; /* Î™®Î∞îÏùºÏóêÏÑú ÏãúÍ∞Ñ Ïª¨Îüº ÎÑàÎπÑ */
    min-width: 75px;
    padding: 5px 3px;
  }

  .time-header {
    font-size: 0.85rem;
    min-height: 85px; /* 4Ìñâ Ìó§ÎçîÏóê ÎßûÍ≤å Ï°∞Ï†ï */
    width: 75px; /* Î™®Î∞îÏùºÏóêÏÑú ÏãúÍ∞Ñ Ïª¨Îüº ÎÑàÎπÑ */
    min-width: 75px;
  }

  /* Îß§Ïö∞ ÏûëÏùÄ ÌôîÎ©¥ÏóêÏÑú ÌîÑÎ°úÍ∑∏Îû® ÌÖåÏù¥Î∏î ÏµúÏÜå ÎÑàÎπÑ */
  .program-table {
    min-width: 700px;
  }
}

/* Ï∫òÎ¶∞Îçî Î©îÎâ¥ Ïä§ÌÉÄÏùº */
.calendar-menu-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.1);
  z-index: 9999;
  backdrop-filter: blur(1px);
}

.calendar-menu-card {
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15) !important;
  border-radius: 8px !important;
  animation: menuFadeIn 0.2s ease-out;
}

@keyframes menuFadeIn {
  from {
    opacity: 0;
    transform: scale(0.95) translateY(-10px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.calendar-option {
  transition: all 0.2s ease !important;
  border-radius: 4px !important;
  margin: 2px 8px !important;
}

.calendar-option:hover {
  background-color: rgba(25, 118, 210, 0.08) !important;
  transform: translateX(4px);
}

.calendar-icon {
  font-size: 1.2rem;
  margin-right: 8px;
}
</style>
